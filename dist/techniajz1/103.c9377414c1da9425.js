"use strict";(self.webpackChunkcion_angular_16=self.webpackChunkcion_angular_16||[]).push([[103],{9103:(G,k,n)=>{n.r(k),n.d(k,{LeaveModule:()=>w});var p=n(177),c=n(9417),_=n(9631),v=n(6911),y=n(9818),S=n(7960),F=n(7062),e=n(4438),f=n(2616),D=n(7575);function C(a,d){1&a&&e.nrm(0,"mat-progress-bar",1)}let R=(()=>{class a{constructor(t,s){this.sharedService=t,this.cdref=s}get isLoading(){return this.sharedService.isLoading}ngAfterContentChecked(){this.cdref.detectChanges()}ngOnInit(){}static#e=this.\u0275fac=function(s){return new(s||a)(e.rXU(f.d),e.rXU(e.gRc))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-leave"]],decls:2,vars:1,consts:[["mode","indeterminate","class","mb-3",4,"ngIf"],["mode","indeterminate",1,"mb-3"]],template:function(s,i){1&s&&(e.DNE(0,C,1,0,"mat-progress-bar",0),e.nrm(1,"router-outlet")),2&s&&e.Y8G("ngIf",i.isLoading)},dependencies:[p.bT,D.HM,F.n3]})}return a})();var j=n(2221),h=n(5312);class I{constructor(d){this.formBuilder=d,this.formGroup=this.formBuilder.group({remark:[null,[c.k0.required]],startDate:["",[c.k0.required]],type:[null,[c.k0.required]],endDate:["",[c.k0.required]],description:[""]})}}var r=n(1626);let l=(()=>{class a{constructor(t,s){this.sharedService=t,this.http=s,this.leaveUrl=h.c.adminUrl+"/Employees"}getLeaveHistory(t){return this.sharedService.getRequest(this.leaveUrl+"/leaveList",t)}updateLeaveStatus(t,s){return this.sharedService.postRequest(this.leaveUrl+"/leaveStatus/"+t,s)}createLeaveRequest(t){return this.sharedService.postRequest(this.leaveUrl+"/leaveRequest",t)}getLeaveType(){return this.sharedService.getRequest(this.leaveUrl+"/leaveTypeDropdown")}static#e=this.\u0275fac=function(s){return new(s||a)(e.KVO(f.d),e.KVO(r.Qq))};static#t=this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();function o(a,d){if(1&a){const t=e.RV6();e.j41(0,"div",25),e.EFF(1),e.j41(2,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeAlert())}),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(),e.SpI(" ",t.errorMessage," ")}}let u=(()=>{class a{constructor(t,s,i){this.formBuilder=t,this.sharedService=s,this.leaveService=i,this.closeModal=new e.bkB,this.remarks=[],this.type=[]}ngOnInit(){console.log(this.ProjectDetails),this.addEditLeaveForm=new I(this.formBuilder),this.getLeaveDropdown()}closeModel(){this.closeModal.emit()}closeAlert(){this.errorMessage=null}createLeaveRequest(){const t=localStorage.getItem("userId");if(this.errorMessage=null,this.addEditLeaveForm.formGroup.valid){const s={...this.addEditLeaveForm.formGroup.value,empId:t};this.leaveService.createLeaveRequest(s).subscribe(i=>{i.success&&this.closeModel()})}else this.errorMessage="Please fill out the required fields before submitting."}getLeaveDropdown(){this.leaveService.getLeaveType().subscribe(t=>{this.remarks=t.data.remark,this.type=t.data.type})}static#e=this.\u0275fac=function(s){return new(s||a)(e.rXU(c.ok),e.rXU(f.d),e.rXU(l))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-add-leave"]],inputs:{ProjectDetails:"ProjectDetails"},outputs:{closeModal:"closeModal"},decls:43,vars:6,consts:[[1,"modal-content"],[1,"modal-toggle-wrapper","text-start","dark-sign-up"],[1,"row","align-items-center"],["type","button","aria-label","Close",1,"btn-close","position-absolute","top-0","end-0","m-2","close-btn",3,"click"],[1,"col-12"],[1,"modal-header","justify-content-center","border-0","pb-0","m-0"],[1,"modal-body"],["class","alert alert-danger d-flex justify-content-between align-items-center",4,"ngIf"],[1,"table-responsive","theme-scroollbar",3,"formGroup"],[1,"form-group","mb-3"],["for","remark",1,"form-label","btn-font"],[1,"font-danger"],["id","Title","bindLabel","name","bindValue","name","placeholder","select remark","formControlName","remark",3,"items","clearable"],[1,"justify-content-start","row","mx-0","mb-2"],[1,"form-group","col-md-6","mb-3"],["for","startDate",1,"form-label","btn-font"],["type","date","placeholder","start Date","autocomplete","off","formControlName","startDate","id","startDate",1,"form-control"],["for","endDate",1,"form-label","btn-font"],["type","date","placeholder","end Date","autocomplete","off","formControlName","endDate","id","endDate",1,"form-control"],["for","type",1,"form-label","btn-font"],["id","Title","bindLabel","name","bindValue","name","placeholder","select leave type","formControlName","type",3,"items","clearable"],["for","description",1,"form-label","btn-font"],["type","text","placeholder","reason","autocomplete","off","formControlName","description","id","description",1,"form-control"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","btn-primary","btn-block",3,"click"],[1,"alert","alert-danger","d-flex","justify-content-between","align-items-center"],["type","button","aria-label","Close",1,"btn-close",3,"click"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e.bIt("click",function(){return i.closeModel()}),e.k0s(),e.j41(4,"div",4)(5,"h3",5),e.EFF(6," Leave Request "),e.k0s()()(),e.nrm(7,"hr"),e.j41(8,"div",6),e.DNE(9,o,3,1,"div",7),e.j41(10,"form",8)(11,"div",9)(12,"label",10),e.EFF(13,"Remark"),e.j41(14,"a",11),e.EFF(15,"*"),e.k0s()(),e.nrm(16,"ng-select",12),e.k0s(),e.j41(17,"div",13)(18,"div",14)(19,"label",15),e.EFF(20,"Start Date"),e.j41(21,"a",11),e.EFF(22,"*"),e.k0s()(),e.nrm(23,"input",16),e.k0s(),e.j41(24,"div",14)(25,"label",17),e.EFF(26,"End Date"),e.j41(27,"a",11),e.EFF(28,"*"),e.k0s()(),e.nrm(29,"input",18),e.k0s()(),e.j41(30,"div",9)(31,"label",19),e.EFF(32,"Leave Type"),e.j41(33,"a",11),e.EFF(34,"*"),e.k0s()(),e.nrm(35,"ng-select",20),e.k0s(),e.j41(36,"div",9)(37,"label",21),e.EFF(38,"Reason"),e.k0s(),e.nrm(39,"input",22),e.k0s(),e.j41(40,"div",23)(41,"button",24),e.bIt("click",function(){return i.createLeaveRequest()}),e.EFF(42,"Request Leave"),e.k0s()()()()()()),2&s&&(e.R7$(9),e.Y8G("ngIf",i.errorMessage),e.R7$(),e.Y8G("formGroup",i.addEditLeaveForm.formGroup),e.R7$(6),e.Y8G("items",i.remarks)("clearable",!1),e.R7$(19),e.Y8G("items",i.type)("clearable",!1))},dependencies:[p.bT,c.qT,c.me,c.BC,c.cb,c.j4,c.JD,y.vr],styles:["input[type=date][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{background:transparent;color:transparent;cursor:pointer;height:auto;inset:0;position:absolute;width:auto}.close-btn[_ngcontent-%COMP%]{z-index:3}.alert[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]})}return a})();var b=n(6536),L=n(7673),$=n(9652);function g(a,d){1&a&&(e.j41(0,"th"),e.EFF(1,"Action"),e.k0s())}function E(a,d){if(1&a&&(e.j41(0,"p",19),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG(2);e.R7$(),e.JRh(s.formatLeaveDate(t.dates[0].date.toString()))}}function T(a,d){if(1&a&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG(2);e.R7$(),e.SpI("- ",s.formatLeaveDate(t.dates[t.dates.length-1].date.toString()),"")}}function M(a,d){if(1&a){const t=e.RV6();e.j41(0,"ul",21)(1,"button",22),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,m=e.XpG(2);return e.Njj(m.changeLeaveStatus(i._id,"Approved"))}),e.nrm(2,"i",23),e.k0s(),e.j41(3,"button",24),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,m=e.XpG(2);return e.Njj(m.changeLeaveStatus(i._id,"Rejected"))}),e.nrm(4,"app-feathericon",25),e.k0s()()}2&a&&(e.R7$(4),e.Y8G("icon","x"))}function P(a,d){if(1&a&&(e.j41(0,"td"),e.DNE(1,M,5,1,"ul",20),e.k0s()),2&a){const t=e.XpG().$implicit,s=e.XpG(2);e.R7$(),e.Y8G("ngIf",s.isPermission&&"Pending"===t.status)}}function X(a,d){if(1&a&&(e.j41(0,"tr")(1,"td")(2,"p",16),e.EFF(3),e.k0s()(),e.j41(4,"td")(5,"div",17),e.DNE(6,E,2,1,"p",18)(7,T,2,1,"p",14),e.k0s()(),e.j41(8,"td")(9,"p",16),e.EFF(10),e.k0s()(),e.j41(11,"td")(12,"p",16),e.EFF(13),e.k0s()(),e.j41(14,"td")(15,"p",16),e.EFF(16),e.k0s()(),e.DNE(17,P,2,1,"td",14),e.k0s()),2&a){const t=d.$implicit,s=e.XpG(2);e.R7$(3),e.JRh(t.employee_id.name),e.R7$(3),e.Y8G("ngIf",t.dates.length>0),e.R7$(),e.Y8G("ngIf",t.dates.length>1),e.R7$(3),e.JRh(t.description),e.R7$(3),e.JRh(t.dayCount),e.R7$(3),e.JRh(t.notes),e.R7$(),e.Y8G("ngIf",s.isPermission)}}function U(a,d){if(1&a&&(e.qex(0),e.DNE(1,X,18,7,"tr",15),e.bVm()),2&a){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.leaveHistoryData)}}function N(a,d){1&a&&(e.qex(0),e.j41(1,"tr")(2,"td",26),e.EFF(3,"No Record Found"),e.k0s()(),e.bVm())}const B=[{path:"",component:R,children:[{path:"list",component:(()=>{class a{constructor(t,s,i,m){this.sharedService=t,this.leaveService=s,this.service=i,this.modalService=m,this.leaveHistoryData=[],this.pageIndex=h.k.page,this.pageSize=h.k.pageSize,this.imageFullPath=h.c.imageBaseUrl,this.isPermission=!0,this.paginationDisabled=!1,this.teamId="",this.validate=!1,this.active=1}ngOnInit(){this.pageItemList=b.g1,this.checkPermission(),this.getLeaveData()}loadPage(t,s){this.pageSize=s,this.pageIndex=t,this.checkPermission(),this.getLeaveData()}onRefreshData(){this.service.page=h.k.page,this.service.pageSize=h.k.pageSize,this.pageIndex=h.k.page,this.pageSize=h.k.pageSize,this.checkPermission(),this.getLeaveData()}getLeaveData(){this.isPermission||(this.teamId=localStorage.getItem("userId")||""),this.paginationDisabled=!1,this.sharedService.isLoading=!0,this.leaveService.getLeaveHistory({empId:this.teamId,page:this.pageIndex,limit:this.pageSize}).subscribe(s=>{s.success&&(this.leaveHistoryData=s.data.leaveRequests,this.total$=(0,L.of)(s.data.pagination.totalRecords))},s=>{s&&s.error&&("Unauthorized access."===s.error.message?this.sharedService.logOut():this.sharedService.displayServerMessage(s.error.message,"error")),this.sharedService.isLoading=!1,this.paginationDisabled=!1},()=>{this.sharedService.isLoading=!1,this.paginationDisabled=!0})}formatLeaveDate(t){const s=parseInt(t.substring(0,4)),i=parseInt(t.substring(4,6))-1,m=parseInt(t.substring(6,8)),x=new Date(s,i,m);return`${x.getDate()}/${x.getMonth()+1}/${x.getFullYear()}`}checkPermission(){const t=localStorage.getItem("permission");let s={};null!==t&&(s=JSON.parse(t),this.isPermission=s.leave)}changeLeaveStatus(t,s){this.leaveService.updateLeaveStatus(t,{status:s}).subscribe(i=>{i.success&&this.getLeaveData()})}openModal(){this.onProjectDetailModal()}onProjectDetailModal(){const t=this.modalService.open(u,{size:"lg"});t.componentInstance.ProjectDetails="hi",t.componentInstance.closeModal.subscribe(()=>{this.getLeaveData(),t.close()})}static#e=this.\u0275fac=function(s){return new(s||a)(e.rXU(f.d),e.rXU(l),e.rXU(j.a),e.rXU(v.Bq))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["app-leave-list"]],features:[e.Jv_([j.a,p.QX])],decls:33,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"row","justify-content-between","mb-2"],[1,"mx-0","row",2,"width","60%"],[1,"col-md-3","mx-1"],[1,"w-40","text-end"],[1,"btn-group","text-start","mb-2","mx-1"],[1,"btn","btn-outline-primary",3,"click"],[1,"icon-reload"],[1,"icon-plus"],[1,"table-responsive","theme-scroollbar"],[1,"table","table-responsive","table-striped","mt-3"],[2,"width","15rem"],[2,"width","20rem"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"my-1"],[1,"d-flex"],["class","me-1",4,"ngIf"],[1,"me-1"],["class","action",4,"ngIf"],[1,"action"],["ngbTooltip","Approve",1,"btn-outline-success","btn-sm","mx-1",3,"click"],[1,"icon-check"],["ngbTooltip","Reject",1,"btn-outline-danger","btn-sm","mx-1",3,"click"],[3,"icon"],["colspan","5",1,"text-center"]],template:function(s,i){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.nrm(4,"div",4),e.k0s(),e.j41(5,"div",5)(6,"div",6)(7,"button",7),e.bIt("click",function(){return i.onRefreshData()}),e.EFF(8,"Refresh "),e.nrm(9,"i",8),e.k0s()(),e.j41(10,"div",6)(11,"button",7),e.bIt("click",function(){return i.openModal()}),e.EFF(12,"Add "),e.nrm(13,"i",9),e.k0s()()()(),e.nrm(14,"hr"),e.j41(15,"form",10)(16,"table",11)(17,"thead")(18,"tr")(19,"th"),e.EFF(20,"Name"),e.k0s(),e.j41(21,"th",12),e.EFF(22,"Date"),e.k0s(),e.j41(23,"th",13),e.EFF(24,"Reason"),e.k0s(),e.j41(25,"th"),e.EFF(26,"Leave Type and Days"),e.k0s(),e.j41(27,"th"),e.EFF(28,"Admin Response"),e.k0s(),e.DNE(29,g,2,0,"th",14),e.k0s()(),e.j41(30,"tbody"),e.DNE(31,U,2,1,"ng-container",14)(32,N,4,0,"ng-container",14),e.k0s()()()()()),2&s&&(e.R7$(29),e.Y8G("ngIf",i.isPermission),e.R7$(2),e.Y8G("ngIf",i.leaveHistoryData.length>0),e.R7$(),e.Y8G("ngIf",0==i.leaveHistoryData.length))},dependencies:[p.Sq,p.bT,$.K,v.md,c.qT,c.cb,c.cV]})}return a})(),data:{title:"Leave Board"}}]}];let O=(()=>{class a{static#e=this.\u0275fac=function(s){return new(s||a)};static#t=this.\u0275mod=e.$C({type:a});static#s=this.\u0275inj=e.G2t({imports:[F.iI.forChild(B),F.iI]})}return a})(),w=(()=>{class a{static#e=this.\u0275fac=function(s){return new(s||a)};static#t=this.\u0275mod=e.$C({type:a});static#s=this.\u0275inj=e.G2t({imports:[p.MD,S.G,v.c9,v.h_,c.YN,c.X1,v.UN,_.fS,y.MQ,v.Pv,O]})}return a})()},2221:(G,k,n)=>{n.d(k,{a:()=>I});var p=n(4412),c=n(1413),_=n(7673);const v=[];var y=n(8141),S=n(152),F=n(5558),e=n(1986),f=n(5312),D=n(4438),C=n(177);let I=(()=>{class r{constructor(o){this.pipe=o,this._loading$=new p.t(!0),this._search$=new c.B,this._data$=new p.t([]),this._total$=new p.t(0),this._state={page:f.k.page,pageSize:f.k.pageSize,searchTerm:"",sortColumn:"",sortDirection:""},this._search$.pipe((0,y.M)(()=>this._loading$.next(!0)),(0,S.B)(200),(0,F.n)(()=>this._search()),(0,e.c)(200),(0,y.M)(()=>this._loading$.next(!1))).subscribe(u=>{this._data$.next(u.Details),this._total$.next(u.total)}),this._search$.next()}get supportdata$(){return this._data$.asObservable()}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}set page(o){this._set({page:o})}set pageSize(o){this._set({pageSize:o})}set searchTerm(o){this._set({searchTerm:o})}set sortColumn(o){this._set({sortColumn:o})}set sortDirection(o){this._set({sortDirection:o})}_set(o){Object.assign(this._state,o),this._search$.next()}_search(){const{sortColumn:o,sortDirection:u,pageSize:b,page:L,searchTerm:$}=this._state;let g=function j(r,l,o){return""===o||""===l?r:[...r].sort((u,b)=>{const L=((r,l)=>r<l?-1:r>l?1:0)(u[l],b[l]);return"asc"===o?L:-L})}(v,o,u);g=g.filter(T=>function h(r,l,o){return r.name.toLowerCase().includes(l.toLowerCase())||r.position.toLowerCase().includes(l.toLowerCase())||o.transform(r.salary).includes(l)||r.office.toLowerCase().includes(l.toLowerCase())||o.transform(r.extn).includes(l)||r.email.toLowerCase().includes(l.toLowerCase())}(T,$,this.pipe));const E=g.length;return g=g.slice((L-1)*b,(L-1)*b+b),(0,_.of)({Details:g,total:E})}static#e=this.\u0275fac=function(u){return new(u||r)(D.KVO(C.QX))};static#t=this.\u0275prov=D.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()}}]);